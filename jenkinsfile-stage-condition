boolean testStatus = true

pipline {
    agent any
        stages {
            stage ('BUILD') {
                steps {
                    echo "this is build stage"
                }

            }

            stage ('TEST') {
                steps {
                    try {
                        echo "running the test cases"
                        sh 'sleep 5'
                        sh 'exit 1'
                    } catch (Expections e) {
                        echo "got an extension, need to hamndle it."
                        echo "$e"
                        testStatus = false 
                    }
                }

            }

            stage ('DEPLOY') {
                steps {
                    if (testStatus == true) {
                       echo "deploy the app to server" 
                    } else {
                        echo "skipping deployment"   
                    }
                }

            }

            stage ( 'NOTIFICATION' ) {
                steps {
                    if (testStatus == true) {
                        echo "notify the test failure"   
                    } else {
                        echo "skipping notification"

                    }
                }

            }
        }
        
}